<div class="mb-5">
  <div class="form-group">
    <%= label_tag :sample_kind, SampleKind.model_name.human %>
    <%= select_tag :sample_kind, options_from_collection_for_select(@sample_kinds, 'id', 'name'), {class: 'form-control', id: 'sample_kind'} %>
  </div>

  <div class = 'form-group'>
    <%= label_tag :collection_date, Sample.human_attribute_name(:collection_date) %><br/>
    <%= select_date Date.today, {order: [:day, :month, :year]}, {class: 'form-control date-select '} %>
  </div>

  <div class = 'form-group'>
    <%= label_tag Sample.human_attribute_name(:bottles_number) %>
    <%= number_field_tag :bottles_number, '1', {class: 'form-control', id: 'bottles_number'} %>
  </div>

  <button id = 'btn_add_sample'class="btn btn-outline-primary">
    Adicionar
  </button>
</div>




<table class = 'table text-center'>
  <thead class = 'text-white bg-dark'>
    <th>
      <h4>Tipo</h4>
    </th>
    <th>
      <h4>Data de coleta</h4>
    </th>
    <th>
      <h4>Frascos</h4>
    </th>
    <th></th>
    <th hidden>Id</th>
  </thead>
  <tbody id = 'samples_table'>
  </tbody>
</table>

<script>
  function remove_sample_line(event){
    let button = event.target
    line = $(button).parent().parent()
    line.remove()
  }
</script>

<script>
  $('#btn_add_sample').click(() => {
    let sample_kind = {
      id: $('#sample_kind').val(),
      name: $('#sample_kind option:selected').text()
    }
    let day = $('#date_day').val()
    let month = $('#date_month').val()
    let year = $('#date_year').val()
    let date = {
      day: day,
      month: month,
      year: year
    }
    let bottles_number = $('#bottles_number').val()
    let sample = {
      sample_kind,
      date,
      bottles_number
    }
    $('#samples_table').append(`
        <tr class = 'sample'>
          <td>
            ${sample.sample_kind.name}
          </td>
          <td>
            <span class = 'collection_date'>
              ${sample.date.day}/${sample.date.month}/${sample.date.year}
            </span>
          </td>
          <td>
            <span class = 'bottles_number'>
              ${sample.bottles_number}
            </span>
          </td>
          <td>
            <button class = 'btn btn-sm btn-outline-danger' onclick=remove_sample_line(event)>
              Remover
            </button>
          </td>
          <td hidden>
            <span class = 'sample_kind_id'>
              ${sample.sample_kind.id}
            </span>
          </td>
        </tr>
      `)
  })  
</script>